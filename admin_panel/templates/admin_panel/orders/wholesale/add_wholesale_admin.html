{% extends 'admin_panel/shared/_admin_layout.html' %}

{% block title %}
    ایجاد سفارش
{% endblock %}

{% block content %}

    <div class="row">
        <div class="col-md-12">
            {% if messages %}
                {% for message in messages %}
                    <div class=" alert alert-{{ message.tags }}" role="alert">
                        <button type="button" class="close" data-dismiss="alert" aria-label="close"><span
                                aria-hidden="true">&times;</span></button>
                        {{ message }}
                    </div>
                {% endfor %}
            {% endif %}
            <div class="card shadow mb-4">
                <div class="card-header">
                    <strong class="card-title">ایجاد سفارش جدید</strong>
                </div>
                <div class="card-body">
                    <form enctype="multipart/form-data" method="post"
                          action="{% url 'add_wholesale_admin_page' %}"
                          novalidate="">
                        {% csrf_token %}
                        <div class="form-row">
                            <div class="col-md-3 mb-3">
                                <label>نام و نام خانوادگی</label>
                                {{ form.full_name }}
                            </div>
                            <div class="col-md-3 mb-3">
                                <label>نام شرکت</label>
                                <div class="input-group">
                                    {{ form.company_name }}
                                </div>
                            </div>
                            <div class="col-md-3 mb-3">
                                <label>شماره موبایل</label>
                                {{ form.phone_number }}
                            </div>
                            <div class="col-md-3 mb-3">
                                <label>شماره ثابت</label>
                                {{ form.landline_phone }}
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3 mb-3">
                                <label>ایمیل</label>
                                {{ form.email }}
                            </div>
                            <div class="col-md-3 mb-3">
                                <label>بیانه</label>
                                {{ form.statement }}
                                <span id="formattedAmount1"></span>
                            </div>
                            <div class="col-md-3 mb-3">
                                <label>کل مبلغ پرداخت شده</label>
                                {{ form.total_amount_paid }}
                                <span id="formattedAmount2"></span>
                            </div>
                            <div class="col-md-3 mb-3">
                                <label>کل مبلغ قابل پرداخت</label>
                                {{ form.total_amount_payable }}
                                <span id="formattedAmount3"></span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12 mb-3">
                                <label>آدرس کامل</label>
                                {{ form.full_address }}
                            </div>
                        </div>
                        <div class="row mt-3">
                            <label class="p-3">محصولات</label>
                            <div class="form-group">
                                {{ form.product }}
                                {{ form.media }}
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4 my-4">
                                <div class="custom-control custom-checkbox mb-3">
                                    {{ form.payment_status }}
                                    <label class="custom-control-label" for="customControlValidation1">پرداخت شده /
                                        نشده</label>
                                </div>
                            </div>
                            <div class="col-md-8 mb-3">
                                <label>وضعیت سفارش</label>
                                {{ form.status }}
                            </div>

                        </div>
                        <button class="btn btn-primary" type="submit">ایجاد</button>
                    </form>
                </div> <!-- /.card-body -->
            </div> <!-- /.card -->
        </div>
    </div>

    <script>
        // currency-converter.js
        function setupInputField(fieldId, formattedId) {
            const inputTomans = document.getElementById(fieldId);
            const formattedAmount = document.getElementById(formattedId);

            inputTomans.addEventListener('input', () => {
                const inputValue = inputTomans.value.trim();
                const numericValue = parseFloat(inputValue.replace(/[^\d.]/g, '')); // Extract numeric part
                if (!isNaN(numericValue)) {
                    // Format with commas every three digits
                    const formattedValue = numericValue.toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                    formattedAmount.textContent = `${formattedValue} تومان`;
                } else {
                    formattedAmount.textContent = '';
                }
            });

            // Trigger the 'input' event once to format any initial value
            inputTomans.dispatchEvent(new Event('input'));
        }

        // Set up input field handlers
        setupInputField('inputTomans1', 'formattedAmount1');
        setupInputField('inputTomans2', 'formattedAmount2');
        setupInputField('inputTomans3', 'formattedAmount3');
        // Add more input fields and display elements as needed

    </script>
{% endblock %}
